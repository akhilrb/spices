"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[229],{9332:(e,r,s)=>{s.d(r,{A:()=>n});s(5043);var t=s(3216),a=s(5475),i=s(579);const n=e=>{let{children:r}=e;const s=(0,t.zy)(),n=[{path:"/admin",name:"Dashboard",icon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{path:"/admin/orders",name:"Orders",icon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})},{path:"/admin/products",name:"Products",icon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})},{path:"/admin/users",name:"Users",icon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{path:"/admin/sales-dashboard",name:"Sales Dashboard",icon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 11V7a4 4 0 118 0v4m-1 4h-6m6 0a2 2 0 11-4 0m4 0a2 2 0 11-4 0m-4 0H5m6 0a2 2 0 11-4 0m4 0a2 2 0 11-4 0"})})}];return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-100 flex",children:[(0,i.jsxs)("div",{className:"w-64 bg-white shadow-lg",children:[(0,i.jsx)("div",{className:"h-16 bg-green-700 flex items-center px-6",children:(0,i.jsx)("span",{className:"text-white text-lg font-semibold",children:"Admin Panel"})}),(0,i.jsxs)("nav",{className:"mt-6",children:[n.map((e=>(0,i.jsxs)(a.N_,{to:e.path,className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100 ".concat(s.pathname===e.path?"bg-gray-100 border-r-4 border-green-700":""),children:[e.icon,(0,i.jsx)("span",{className:"mx-3",children:e.name})]},e.path))),(0,i.jsxs)(a.N_,{to:"/",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100 mt-4",children:[(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,i.jsx)("span",{className:"mx-3",children:"Back to Site"})]})]})]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"bg-white shadow-sm h-16 flex items-center px-8",children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex items-center space-x-4",children:(0,i.jsx)("span",{className:"text-gray-700",children:"Admin"})})]}),(0,i.jsx)("div",{className:"p-8",children:r})]})]})}},3229:(e,r,s)=>{s.r(r),s.d(r,{default:()=>m});var t=s(5043),a=s(465),i=s(475),n=s(2339),c=s(9379),o=s(579);const l=e=>{let{isOpen:r,onClose:s,product:i,onSuccess:l}=e;const[d,m]=(0,t.useState)([]),[x,u]=(0,t.useState)(""),[h,g]=(0,t.useState)({name:"",description:"",price:"",category:"",image_url:"",stock:""}),[p,y]=(0,t.useState)(!1),[f,j]=(0,t.useState)(null),[b,v]=(0,t.useState)("");(0,t.useEffect)((()=>{i?(g({name:i.name||"",description:i.description||"",price:i.price?i.price.toString():"",category:i.category||"",image_url:i.image_url||"",stock:i.stock?i.stock.toString():""}),v(i.image_url||"")):N()}),[i]);const N=()=>{g({name:"",description:"",price:"",category:"",image_url:"",stock:""}),j(null),v("")};(0,t.useEffect)((()=>{(async()=>{try{const{data:e,error:r}=await a.N.from("categories").select("name").order("name");if(r)throw r;m(e.map((e=>e.name)))}catch(e){n.Ay.error("Error fetching categories"),console.error("Categories fetch error:",e)}})()}),[]);return r?(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:i?"Edit Product":"Add New Product"}),(0,o.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:(0,o.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsx)("form",{onSubmit:async e=>{e.preventDefault(),y(!0);try{if(!h.name||!h.price||!h.category)return n.Ay.error("Please fill in all required fields"),void y(!1);let e=h.image_url;if(f&&(e=await(async e=>{try{const r=e.name.split(".").pop(),s="".concat(Math.random(),".").concat(r),{error:t,data:i}=await a.N.storage.from("product-images").upload(s,e,{cacheControl:"3600",upsert:!0});if(t)throw t;const{data:{publicUrl:n},error:c}=a.N.storage.from("product-images").getPublicUrl(s);if(c)throw c;return n}catch(r){return console.error("Error uploading image:",r),n.Ay.error("Failed to upload image"),null}})(f),!e))return void y(!1);const r={name:h.name,description:h.description,price:parseFloat(h.price),category:h.category,image_url:e,stock:parseInt(h.stock)||0};if(i){const{error:e}=await a.N.from("products").update(r).eq("id",i.id);if(e)throw e;n.Ay.success("Product updated successfully")}else{const{error:e}=await a.N.from("products").insert([r]);if(e)throw e;n.Ay.success("Product added successfully")}N(),l(),s()}catch(r){console.error("Error saving product:",r),n.Ay.error(r.message||"Failed to save product")}finally{y(!1)}},className:"p-6",children:(0,o.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name"}),(0,o.jsx)("input",{type:"text",value:h.name,onChange:e=>g((0,c.A)((0,c.A)({},h),{},{name:e.target.value})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter product name",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,o.jsx)("textarea",{value:h.description,onChange:e=>g((0,c.A)((0,c.A)({},h),{},{description:e.target.value})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter product description",rows:"3"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (\u20b9)"}),(0,o.jsx)("input",{type:"number",value:h.price,onChange:e=>g((0,c.A)((0,c.A)({},h),{},{price:e.target.value})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter price",min:"0",step:"0.01",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock Quantity"}),(0,o.jsx)("input",{type:"number",value:h.stock,onChange:e=>g((0,c.A)((0,c.A)({},h),{},{stock:e.target.value})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter stock quantity",min:"0"})]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsxs)("select",{value:h.category,onChange:e=>g((0,c.A)((0,c.A)({},h),{},{category:e.target.value})),className:"flex-grow p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500",children:[(0,o.jsx)("option",{value:"",children:"Select Category"}),d.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]}),(0,o.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"New Category",className:"w-1/3 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500"}),(0,o.jsx)("button",{onClick:async()=>{if(x.trim())try{const{data:e,error:r}=await a.N.from("categories").insert({name:x.trim()}).select("name");if(r){if("23505"!==r.code)throw r;n.Ay.error("This category already exists")}else n.Ay.success('Category "'.concat(x,'" added')),m([...d,x.trim()]),u(""),g((e=>(0,c.A)((0,c.A)({},e),{},{category:x.trim()})))}catch(e){n.Ay.error("Failed to add category"),console.error("Add category error:",e)}else n.Ay.error("Category name cannot be empty")},className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"Add"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Image"}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const r=e.target.files[0];if(r){j(r);const e=new FileReader;e.onloadend=()=>{v(e.result)},e.readAsDataURL(r)}},className:"block w-full text-sm text-gray-500  file:mr-4 file:py-2 file:px-4  file:rounded-full file:border-0  file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"}),b&&(0,o.jsx)("img",{src:b,alt:"Product Preview",className:"h-20 w-20 object-cover rounded-md"})]})]}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors",children:p?(0,o.jsxs)("span",{className:"flex items-center justify-center",children:[(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Product"})})]})})]})}):null};var d=s(9332);const m=()=>{const[e,r]=(0,t.useState)([]),[s,c]=(0,t.useState)(!0),[m,x]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null),[g,p]=(0,t.useState)(""),[y,f]=(0,t.useState)(!1),[j,b]=(0,t.useState)("list"),[v,N]=(0,t.useState)(1),[w,k]=(0,t.useState)(10);(0,t.useEffect)((()=>{C(),A()}),[]);const C=async()=>{try{c(!0);const{data:e,error:s}=await a.N.from("products").select("*").order("created_at",{ascending:!1});if(s)throw s;r(e)}catch(e){console.error("Error fetching products:",e),n.Ay.error("Failed to load products")}finally{c(!1)}},A=async()=>{try{var e,r;const{data:{session:s}}=await a.N.auth.getSession();if(null===s||void 0===s||!s.user)return void f(!1);const t=s.user,i=!0===(null===(e=t.user_metadata)||void 0===e?void 0:e.is_admin)||!0===(null===(r=t.app_metadata)||void 0===r?void 0:r.is_admin);if(f(i),!i)return}catch(s){f(!1),n.Ay.error("Failed to verify admin status")}},S=async s=>{if(window.confirm("Are you sure you want to delete this product?"))try{const{error:t}=await a.N.from("products").delete().eq("id",s);if(t)throw t;r(e.filter((e=>e.id!==s))),n.Ay.success("Product deleted successfully")}catch(t){console.error("Error deleting product:",t),n.Ay.error("Failed to delete product")}},L=e.filter((e=>e.name.toLowerCase().includes(g.toLowerCase())||e.description.toLowerCase().includes(g.toLowerCase())||e.origin.toLowerCase().includes(g.toLowerCase()))),P=Math.ceil(L.length/w),M=()=>{const e=(v-1)*w;return L.slice(e,e+w)};return s?(0,o.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,o.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-700"})})}):(0,o.jsx)(d.A,{children:(0,o.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,o.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Manage Products"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Add, edit, and manage your product inventory"})]}),(0,o.jsxs)("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:[(0,o.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add New Product"]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("button",{onClick:()=>b("list"),className:"px-4 py-2 rounded ".concat("list"===j?"bg-green-600 text-white":"bg-gray-200"),children:"List View"}),(0,o.jsx)("button",{onClick:()=>b("tiles"),className:"mr-2 px-4 py-2 rounded ".concat("tiles"===j?"bg-green-600 text-white":"bg-gray-200"),children:"Tiles View"})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"mr-2",children:"Items per page:"}),(0,o.jsxs)("select",{value:w,onChange:e=>{k(Number(e.target.value)),N(1)},className:"border border-gray-300 rounded-md",children:[(0,o.jsx)("option",{value:5,children:"5"}),(0,o.jsx)("option",{value:10,children:"10"}),(0,o.jsx)("option",{value:20,children:"20"}),(0,o.jsx)("option",{value:50,children:"50"})]})]}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:(0,o.jsxs)("div",{className:"max-w-lg",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Products"}),(0,o.jsx)("input",{type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"Search by name, description, or origin...",className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"})]})}),"tiles"===j?(0,o.jsx)("div",{className:"grid grid-cols-5 gap-4",children:M().map(((e,r)=>(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden p-2",children:[(0,o.jsx)("div",{className:"aspect-w-16 aspect-h-9",children:(0,o.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-32 object-cover"})}),(0,o.jsxs)("div",{className:"p-2",children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,o.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(0,i.$)(e.price)}),(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:["Origin: ",e.origin]})]}),(0,o.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Category: ",e.category]}),(0,o.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,o.jsx)("button",{onClick:()=>h(e),className:"flex-1 inline-flex justify-center items-center px-2 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Edit"}),(0,o.jsx)("button",{onClick:()=>S(e.id),className:"flex-1 inline-flex justify-center items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]},e.id)))}):(0,o.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SL No"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product Name"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origin"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M().map(((e,r)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(v-1)*w+r+1}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("img",{src:e.image_url,alt:e.name,className:"w-12 h-12 object-cover rounded"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,i.$)(e.price)}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.origin}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.category}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.stock}),(0,o.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,o.jsx)("button",{onClick:()=>h(e),className:"text-blue-600 hover:text-blue-900",children:"Edit"}),(0,o.jsx)("button",{onClick:()=>S(e.id),className:"text-red-600 hover:text-red-900 ml-4",children:"Delete"})]})]},e.id)))})]})}),(0,o.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,o.jsx)("button",{onClick:()=>N((e=>Math.max(e-1,1))),disabled:1===v,className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",children:"Previous"}),(0,o.jsxs)("span",{children:["Page ",v," of ",P]}),(0,o.jsx)("button",{onClick:()=>N((e=>Math.min(e+1,P))),disabled:v===P,className:"px-4 py-2 bg-gray-300 rounded disabled:opacity-50",children:"Next"})]})]}),(0,o.jsx)(l,{isOpen:m||null!==u,onClose:()=>{x(!1),h(null)},product:u,onSuccess:()=>{C()}})]})})}},475:(e,r,s)=>{s.d(r,{$:()=>t});const t=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e)}}]);
//# sourceMappingURL=229.7651f171.chunk.js.map